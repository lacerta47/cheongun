<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPS Í≤åÏûÑ</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            cursor: crosshair;
            background-color: #333;
            color: white;
            font-family: 'Arial', sans-serif;
            user-select: none;
        }
        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: url('https://via.placeholder.com/800x600/000022/000022') no-repeat center center;
            background-size: cover;
        }
        .enemy {
            position: absolute;
            width: 70px; /* Slightly wider */
            height: 90px; /* Slightly taller */
            background: radial-gradient(circle at 50% 40%, #ff8080, #d10000);
            border: 1px solid #600;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            transition: transform 0.1s;
        }
        .enemy::before {
            content: 'üëø'; /* Enemy face */
            font-size: 40px;
        }
        #player-hud {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-size: 24px;
        }
        #weapon {
            position: absolute;
            bottom: 0px; /* Keep at bottom */
            left: 50%;
            transform: translateX(-50%);
            width: 300px; /* Larger width */
            height: 120px; /* Larger height */
            background: url('https://via.placeholder.com/300x120/333333/FFFFFF?text=ÎèåÍ≤©ÏÜåÏ¥ù') no-repeat center center;
            background-size: contain;
            transition: transform 0.05s ease-out; /* Smooth movement */
        }
        .muzzle-flash {
            position: absolute;
            bottom: 90px; /* Adjusted for new weapon height */
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(255,223,0,0.8) 0%, rgba(255,165,0,0) 70%);
            border-radius: 50%;
            display: none;
        }
        #game-over, #game-clear {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 72px;
            font-weight: bold;
            color: red;
            text-shadow: 3px 3px 5px black;
            display: none;
        }
        #game-clear {
            color: green;
        }
        .damage-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 0, 0, 0.5);
            display: none;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="weapon"></div>
        <div class="muzzle-flash"></div>
        <div id="player-hud">
            <p>Î†àÎ≤®: <span id="level">1</span></p>
            <p>ÎÇ®ÏùÄ ÏãúÍ∞Ñ: <span id="timer">60</span></p>
            <p>ÎÇ¥ Ï≤¥Î†•: <span id="player-health">100</span></p>
            <p>ÎÇ®ÏùÄ Ï†Å: <span id="enemies-left">5</span></p>
        </div>
        <div id="game-over">Í≤åÏûÑ Ïò§Î≤Ñ</div>
        <div id="game-clear">Î†àÎ≤® ÌÅ¥Î¶¨Ïñ¥!</div>
        <div class="damage-effect"></div>
    </div>

    <script>
        const gameContainer = document.getElementById('game-container');
        const playerHealthEl = document.getElementById('player-health');
        const enemiesLeftEl = document.getElementById('enemies-left');
        const levelEl = document.getElementById('level');
        const timerEl = document.getElementById('timer');
        const gameOverEl = document.getElementById('game-over');
        const gameClearEl = document.getElementById('game-clear');
        const muzzleFlash = document.querySelector('.muzzle-flash');
        const damageEffect = document.querySelector('.damage-effect');
        const weaponEl = document.getElementById('weapon');

        let playerHealth = 100;
        let enemyCount = 5;
        let level = 1;
        let timeLeft = 60;
        let enemies = [];
        let gameIsOver = false;
        let enemyAttackInterval;
        let levelTimerInterval;

        function startLevel() {
            gameIsOver = false;
            levelEl.textContent = level;
            
            playerHealth = 100;
            playerHealthEl.textContent = playerHealth;

            timeLeft = 60;
            timerEl.textContent = timeLeft;

            enemyCount = 4 + level;
            const enemyHealth = 75 + level * 25;
            const attackInterval = Math.max(500, 2200 - level * 200);

            enemies.forEach(e => e.remove());
            enemies = [];
            
            createEnemies(enemyCount, enemyHealth);
            
            clearInterval(enemyAttackInterval);
            enemyAttackInterval = setInterval(enemyAttack, attackInterval);

            clearInterval(levelTimerInterval);
            levelTimerInterval = setInterval(tick, 1000);
        }

        function tick() {
            if (gameIsOver) return;
            timeLeft--;
            timerEl.textContent = timeLeft;
            if (timeLeft <= 0) {
                gameOver();
            }
        }

        function createEnemies(num, health) {
            for (let i = 0; i < num; i++) {
                const enemy = document.createElement('div');
                enemy.classList.add('enemy');
                enemy.health = health;
                enemy.maxHealth = health;
                
                let pos;
                let overlaps;
                do {
                    overlaps = false;
                    pos = {
                        top: Math.random() * 40 + 10,
                        left: Math.random() * 80 + 10,
                    };
                    for(const existing of enemies) {
                        const existingPos = { top: parseFloat(existing.style.top), left: parseFloat(existing.style.left) };
                        const distance = Math.sqrt(Math.pow(pos.top - existingPos.top, 2) + Math.pow(pos.left - existingPos.left, 2));
                        if (distance < 10) {
                            overlaps = true;
                            break;
                        }
                    }
                } while (overlaps);

                enemy.style.top = pos.top + '%';
                enemy.style.left = pos.left + '%';

                enemy.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (gameIsOver) return;
                    shootEnemy(enemy);
                });

                enemies.push(enemy);
                gameContainer.appendChild(enemy);
            }
            enemiesLeftEl.textContent = num;
            enemyCount = num;
        }

        function shootEnemy(enemy) {
            if (enemy.health <= 0) return;

            enemy.health -= 25; // Background color change removed to work with the gradient
            enemy.style.transform = 'scale(1.1)';
            setTimeout(() => {
                enemy.style.transform = 'scale(1)';
            }, 100);

            if (enemy.health <= 0) {
                enemy.style.display = 'none';
                enemyCount--;
                enemiesLeftEl.textContent = enemyCount;
                if (enemyCount <= 0) {
                    levelClear();
                }
            }
        }

        function playerShootEffect() {
            if (gameIsOver) return;
            muzzleFlash.style.display = 'block';
            setTimeout(() => {
                muzzleFlash.style.display = 'none';
            }, 100);
        }

        function enemyAttack() {
            if (gameIsOver) return;

            playerHealth -= 10;
            playerHealthEl.textContent = playerHealth;
            
            damageEffect.style.display = 'block';
            setTimeout(() => {
                damageEffect.style.display = 'none';
            }, 200);

            if (playerHealth <= 0) {
                playerHealth = 0;
                playerHealthEl.textContent = playerHealth;
                gameOver();
            }
        }

        function gameOver() {
            if(gameIsOver) return; // Prevent multiple calls
            gameIsOver = true;
            gameOverEl.style.display = 'block';
            clearInterval(enemyAttackInterval);
            clearInterval(levelTimerInterval);
        }
        
        function levelClear() {
            gameIsOver = true;
            clearInterval(enemyAttackInterval);
            clearInterval(levelTimerInterval);
            gameClearEl.textContent = `Î†àÎ≤® ${level} ÌÅ¥Î¶¨Ïñ¥!`;
            gameClearEl.style.display = 'block';
            
            setTimeout(() => {
                gameClearEl.style.display = 'none';
                level++;
                startLevel();
            }, 2000);
        }

        // Game Start
        gameContainer.addEventListener('click', playerShootEffect);
        gameContainer.addEventListener('mousemove', (e) => {
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const mouseX = e.clientX;
            const mouseY = e.clientY;

            const offsetX = (mouseX - centerX) * 0.05; // Adjust sensitivity
            const offsetY = (mouseY - centerY) * 0.05; // Adjust sensitivity

            weaponEl.style.transform = `translateX(-50%) translate(${offsetX}px, ${offsetY}px)`;
        });
        startLevel();

    </script>

</body>
</html>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—„ë§ˆ ëª°ë˜ ìƒˆë²½ì— ë¼ë©´ ë“ì´ê¸°</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #333;
            color: white;
        }
        #game-container {
            width: 800px;
            height: 600px;
            border: 2px solid white;
            position: relative;
            background-color: #555;
        }
        .room {
            position: absolute;
            border: 1px solid #aaa;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
        }
        #kitchen { top: 0; left: 0; width: 40%; height: 50%; background-color: #6d6d6d; }
        #living-room { top: 0; left: 40%; width: 60%; height: 60%; background-color: #5a5a5a; }
        #my-room { top: 50%; left: 0; width: 40%; height: 50%; background-color: #5f5f5f; }
        #mom-room { top: 60%; left: 40%; width: 30%; height: 40%; background-color: #505050; }
        #hallway { top: 60%; left: 70%; width: 30%; height: 40%; background-color: #4a4a4a; }
        
        #player, #mom {
            position: absolute;
            width: 40px;
            height: 40px;
            font-size: 30px;
            transition: top 0.5s, left 0.5s;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #player { content: 'ğŸ‘§'; }
        #mom { content: 'ğŸ‘¨â€ğŸ¦²'; }

        .item {
            position: absolute;
            font-size: 25px;
            cursor: pointer;
        }
        #item-pot { top: 5%; left: 35%; } /* ì£¼ë°© */
        #item-water { top: 55%; left: 85%; } /* ê±°ì‹¤ */
        #item-ramen { top: 80%; left: 10%; } /* ë‚´ ë°© */
        #item-soup { top: 80%; left: 80%; } /* ë³µë„ */

        #game-info {
            width: 800px;
            margin-top: 10px;
            display: flex;
            justify-content: space-between;
        }
        #inventory, #status, #lives {
            background-color: #444;
            padding: 10px;
            border-radius: 5px;
        }
        #start-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 30px;
            padding: 20px;
            cursor: pointer;
            background-color: #4CAF50;
            border: none;
            border-radius: 10px;
            color: white;
            z-index: 10;
        }
    </style>
</head>
<body>

<h1>ì—„ë§ˆ ëª°ë˜ ìƒˆë²½ì— ë¼ë©´ ë“ì´ê¸°</h1>

<div id="game-container">
    <div id="kitchen" class="room" data-name="ì£¼ë°©">ì£¼ë°©</div>
    <div id="living-room" class="room" data-name="ê±°ì‹¤">ê±°ì‹¤</div>
    <div id="my-room" class="room" data-name="ë‚´ ë°©">ë‚´ ë°©</div>
    <div id="mom-room" class="room" data-name="ì•ˆë°©">ì•ˆë°©</div>
    <div id="hallway" class="room" data-name="ë³µë„">ë³µë„</div>

    <div id="player">ğŸ‘§</div>
    <div id="mom" style="display: none;">ğŸ‘¨â€ğŸ¦²</div>

    <div id="item-pot" class="item" data-item="ëƒ„ë¹„">ëƒ„ë¹„</div>
    <div id="item-water" class="item" data-item="ë¬¼">ë¬¼</div>
    <div id="item-ramen" class="item" data-item="ë©´">ë©´</div>
    <div id="item-soup" class="item" data-item="ìŠ¤í”„">ìŠ¤í”„</div>
    
    <button id="start-btn">ê²Œì„ ì‹œì‘</button>
</div>

<div id="game-info">
    <div id="inventory"><strong>ê°€ë°©:</strong> </div>
    <div id="status">ì—„ë§ˆê°€ ê³§ ë‚˜ì˜¬ ìˆ˜ ìˆì–´ìš”...</div>
    <div id="lives"><strong>ìƒëª…:</strong> â¤ï¸â¤ï¸â¤ï¸</div>
</div>

<script>
    const player = document.getElementById('player');
    const mom = document.getElementById('mom');
    const rooms = document.querySelectorAll('.room');
    const items = document.querySelectorAll('.item');
    const startBtn = document.getElementById('start-btn');

    const statusEl = document.getElementById('status');
    const livesEl = document.getElementById('lives');
    const inventoryEl = document.getElementById('inventory');

    const roomPositions = {
        'ì£¼ë°©': { top: '25%', left: '20%' },
        'ê±°ì‹¤': { top: '30%', left: '70%' },
        'ë‚´ ë°©': { top: '75%', left: '20%' },
        'ì•ˆë°©': { top: '80%', left: '55%' },
        'ë³µë„': { top: '80%', left: '85%' }
    };

    let playerPos = 'ë‚´ ë°©';
    let momPos = 'ì•ˆë°©';
    let lives = 3;
    let inventory = [];
    let momIsOut = false;
    let momTimer;
    let gameRunning = false;

    startBtn.addEventListener('click', startGame);

    function startGame() {
        gameRunning = true;
        startBtn.style.display = 'none';
        playerPos = 'ë‚´ ë°©';
        momPos = 'ì•ˆë°©';
        lives = 3;
        inventory = [];
        momIsOut = false;
        
        updatePlayerPos();
        updateUI();
        resetItems();

        momTimer = setInterval(momCycle, 1000); // ì—„ë§ˆ íƒ€ì´ë¨¸ ì‹œì‘
        statusEl.textContent = "ì¡°ìš©íˆ ì›€ì§ì´ì„¸ìš”...";
    }

    function momCycle() {
        if (!gameRunning) return;

        if (momIsOut) {
            // ì—„ë§ˆê°€ ë°–ì„ ìˆœì°°í•¨ (30ì´ˆ)
            statusEl.textContent = "ì—„ë§ˆê°€ ë°–ì„ ë³´ê³  ìˆìŠµë‹ˆë‹¤!";
            mom.style.display = 'block';
            
            // ëœë¤í•˜ê²Œ ê±°ì‹¤ì´ë‚˜ ì£¼ë°©ìœ¼ë¡œ ì´ë™
            const patrolSpot = Math.random() < 0.5 ? 'ê±°ì‹¤' : 'ì£¼ë°©';
            momPos = patrolSpot;
            const pos = roomPositions[momPos];
            mom.style.top = pos.top;
            mom.style.left = pos.left;

            checkCaught();

            setTimeout(() => {
                momIsOut = false;
                mom.style.display = 'none';
                momPos = 'ì•ˆë°©';
                statusEl.textContent = "ì—„ë§ˆê°€ ë“¤ì–´ê°”ìŠµë‹ˆë‹¤! (60ì´ˆ)";
            }, 15000); // ì‹¤ì œ ê²Œì„ì—ì„œëŠ” 30ì´ˆ, í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ 15ì´ˆ
        } else {
            // ì—„ë§ˆê°€ ë°©ì— ìˆìŒ (60ì´ˆ)
            setTimeout(() => {
                momIsOut = true;
            }, 30000); // ì‹¤ì œ ê²Œì„ì—ì„œëŠ” 60ì´ˆ, í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ 30ì´ˆ
        }
    }

    rooms.forEach(room => {
        room.addEventListener('click', () => {
            if (!gameRunning || momIsOut) {
                if(momIsOut) statusEl.textContent = "ì—„ë§ˆê°€ ë‚˜ì™€ìˆì„ ë• ì›€ì§ì¼ ìˆ˜ ì—†ì–´ìš”!";
                return;
            };
            playerPos = room.dataset.name;
            updatePlayerPos();
            checkCaught();
        });
    });

    items.forEach(item => {
        item.addEventListener('click', (e) => {
            if (!gameRunning || momIsOut) return;
            const itemName = e.target.dataset.item;
            const itemRoom = e.target.parentElement.querySelector('.room[data-name]').dataset.name;
            
            // ì•„ì´í…œì´ ìˆëŠ” ë°©ê³¼ í”Œë ˆì´ì–´ì˜ ë°©ì´ ê°™ì•„ì•¼ íšë“ ê°€ëŠ¥
            let playerRoomName = '';
            for(const room of rooms){
                const rect = room.getBoundingClientRect();
                const playerRect = player.getBoundingClientRect();
                if(playerRect.top > rect.top && playerRect.left > rect.left && playerRect.bottom < rect.bottom && playerRect.right < rect.right){
                    playerRoomName = room.dataset.name;
                    break;
                }
            }

            if (playerPos === getRoomFromItem(e.target)) {
                if (!inventory.includes(itemName)) {
                    inventory.push(itemName);
                    e.target.style.display = 'none';
                    updateUI();
                    checkWinCondition();
                }
            } else {
                statusEl.textContent = "ì•„ì´í…œì´ ìˆëŠ” ë°©ìœ¼ë¡œ ê°€ì•¼ í•´ìš”!";
            }
        });
    });
    
    function getRoomFromItem(itemElement) {
        if (itemElement.id === 'item-pot') return 'ì£¼ë°©';
        if (itemElement.id === 'item-water') return 'ê±°ì‹¤';
        if (itemElement.id === 'item-ramen') return 'ë‚´ ë°©';
        if (itemElement.id === 'item-soup') return 'ë³µë„';
        return null;
    }


    function updatePlayerPos() {
        const pos = roomPositions[playerPos];
        player.style.top = pos.top;
        player.style.left = pos.left;
    }

    function checkCaught() {
        if (momIsOut && playerPos === momPos) {
            lives--;
            updateUI();
            if (lives <= 0) {
                gameOver(false);
            } else {
                statusEl.textContent = `ì—„ë§ˆì—ê²Œ ë“¤ì¼°ì–´ìš”! ìƒëª…ì´ ${lives}ê°œ ë‚¨ì•˜ìŠµë‹ˆë‹¤.`;
                // ë“¤í‚¤ë©´ ì—„ë§ˆëŠ” ë°”ë¡œ ë°©ìœ¼ë¡œ ëŒì•„ê°
                momIsOut = false;
                mom.style.display = 'none';
                momPos = 'ì•ˆë°©';
            }
        }
    }

    function checkWinCondition() {
        if (inventory.length === 4) {
            if (playerPos === 'ì£¼ë°©') {
                statusEl.textContent = "ì¬ë£Œë¥¼ ë‹¤ ëª¨ì•˜ë‹¤! ë¼ë©´ì„ ë“ì…ë‹ˆë‹¤... (10ì´ˆ)";
                setTimeout(() => {
                    if(lives > 0) gameOver(true);
                }, 10000); // 10ì´ˆ í›„ ìŠ¹ë¦¬
            } else {
                statusEl.textContent = "ì¬ë£Œë¥¼ ë‹¤ ëª¨ì•˜ì–´ìš”! ì£¼ë°©ìœ¼ë¡œ ê°€ì„¸ìš”!";
            }
        }
    }
    
    function resetItems() {
        items.forEach(item => item.style.display = 'block');
    }

    function gameOver(isWin) {
        gameRunning = false;
        clearInterval(momTimer);
        if (isWin) {
            statusEl.textContent = "ë¼ë©´ ë“ì´ê¸° ì„±ê³µ! ë§›ìˆê²Œ ë“œì„¸ìš”!";
            player.textContent = 'ğŸœ';
        } else {
            statusEl.textContent = "ì—„ë§ˆì—ê²Œ ê±¸ë ¸ìŠµë‹ˆë‹¤... ê²Œì„ ì˜¤ë²„!";
            player.textContent = 'ğŸ˜­';
        }
        startBtn.textContent = "ë‹¤ì‹œ ì‹œì‘";
        startBtn.style.display = 'block';
    }

    function updateUI() {
        livesEl.innerHTML = `<strong>ìƒëª…:</strong> ${'â¤ï¸'.repeat(lives)}`;
        inventoryEl.innerHTML = `<strong>ê°€ë°©:</strong> ${inventory.join(', ')}`;
    }

</script>
</body>
</html>
